!function(e){"use strict";var t=e.URL||e.webkitURL;function i(e){return!!t&&t.createObjectURL(e)}function a(e){return!!t&&t.revokeObjectURL(e)}function n(e,t){!e||"blob:"!==e.slice(0,5)||t&&t.noRevoke||a(e)}function r(t,i,a,n){if(!e.FileReader)return!1;var r=new FileReader;r.onload=function(){i.call(r,this.result)},a&&(r.onabort=r.onerror=function(){a.call(r,this.error)});var o=r[n||"readAsDataURL"];return o?(o.call(r,t),r):void 0}function o(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}function s(t,a,c){function l(a,l){var f,u=document.createElement("img");function d(e,t){a!==l?e instanceof Error?l(e):((t=t||{}).image=e,a(t)):a&&a(e,t)}function g(a,n){n&&e.console&&console.log(n),a&&o("Blob",a)?f=i(t=a):(f=t,c&&c.crossOrigin&&(u.crossOrigin=c.crossOrigin)),u.src=f}return u.onerror=function(e){n(f,c),l&&l.call(u,e)},u.onload=function(){n(f,c);var e={originalWidth:u.naturalWidth||u.width,originalHeight:u.naturalHeight||u.height};try{s.transform(u,c,d,t,e)}catch(e){l&&l(e)}},"string"==typeof t?(s.requiresMetaData(c)?s.fetchBlob(t,g,c):g(),u):o("Blob",t)||o("File",t)?(f=i(t))?(u.src=f,u):r(t,function(e){u.src=e},l):void 0}return e.Promise&&"function"!=typeof a?(c=a,new Promise(l)):l(a,a)}s.requiresMetaData=function(e){return e&&e.meta},s.fetchBlob=function(e,t){t()},s.transform=function(e,t,i,a,n){i(e,n)},s.global=e,s.readFile=r,s.isInstanceOf=o,s.createObjectURL=i,s.revokeObjectURL=a,"function"==typeof define&&define.amd?define(function(){return s}):"object"==typeof module&&module.exports?module.exports=s:e.loadImage=s}("undefined"!=typeof window&&window||this),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(e){"use strict";var t=e.transform;e.createCanvas=function(t,i,a){if(a&&e.global.OffscreenCanvas)return new OffscreenCanvas(t,i);var n=document.createElement("canvas");return n.width=t,n.height=i,n},e.transform=function(i,a,n,r,o){t.call(e,e.scale(i,a,o),a,n,r,o)},e.transformCoordinates=function(){},e.getTransformedOptions=function(e,t){var i,a,n,r,o=t.aspectRatio;if(!o)return t;for(a in i={},t)Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i.crop=!0,(n=e.naturalWidth||e.width)/(r=e.naturalHeight||e.height)>o?(i.maxWidth=r*o,i.maxHeight=r):(i.maxWidth=n,i.maxHeight=n/o),i},e.drawImage=function(e,t,i,a,n,r,o,s,c){var l=t.getContext("2d");return!1===c.imageSmoothingEnabled?(l.msImageSmoothingEnabled=!1,l.imageSmoothingEnabled=!1):c.imageSmoothingQuality&&(l.imageSmoothingQuality=c.imageSmoothingQuality),l.drawImage(e,i,a,n,r,0,0,o,s),l},e.requiresCanvas=function(e){return e.canvas||e.crop||!!e.aspectRatio},e.scale=function(t,i,a){i=i||{},a=a||{};var n,r,o,s,c,l,f,u,d,g,m,h,p=t.getContext||e.requiresCanvas(i)&&!!e.global.HTMLCanvasElement,A=t.naturalWidth||t.width,b=t.naturalHeight||t.height,y=A,S=b;function v(){var e=Math.max((o||y)/y,(s||S)/S);e>1&&(y*=e,S*=e)}function E(){var e=Math.min((n||y)/y,(r||S)/S);e<1&&(y*=e,S*=e)}if(p&&(f=(i=e.getTransformedOptions(t,i,a)).left||0,u=i.top||0,i.sourceWidth?(c=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(f=A-c-i.right)):c=A-f-(i.right||0),i.sourceHeight?(l=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(u=b-l-i.bottom)):l=b-u-(i.bottom||0),y=c,S=l),n=i.maxWidth,r=i.maxHeight,o=i.minWidth,s=i.minHeight,p&&n&&r&&i.crop?(y=n,S=r,(m=c/l-n/r)<0?(l=r*c/n,void 0===i.top&&void 0===i.bottom&&(u=(b-l)/2)):m>0&&(c=n*l/r,void 0===i.left&&void 0===i.right&&(f=(A-c)/2))):((i.contain||i.cover)&&(o=n=n||o,s=r=r||s),i.cover?(E(),v()):(v(),E())),p){if((d=i.pixelRatio)>1&&(!t.style.width||Math.floor(parseFloat(t.style.width,10))!==Math.floor(A/d))&&(y*=d,S*=d),e.orientationCropBug&&!t.getContext&&(f||u||c!==A||l!==b)&&(m=t,t=e.createCanvas(A,b,!0),e.drawImage(m,t,0,0,A,b,A,b,i)),(g=i.downsamplingRatio)>0&&g<1&&y<c&&S<l)for(;c*g>y;)h=e.createCanvas(c*g,l*g,!0),e.drawImage(t,h,f,u,c,l,h.width,h.height,i),f=0,u=0,c=h.width,l=h.height,t=h;return h=e.createCanvas(y,S),e.transformCoordinates(h,i,a),d>1&&(h.style.width=h.width/d+"px"),e.drawImage(t,h,f,u,c,l,y,S,i).setTransform(1,0,0,1,0,0),h}return t.width=y,t.height=S,t}}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(e){"use strict";var t=e.global,i=e.transform,a=t.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),n=t.ArrayBuffer&&ArrayBuffer.prototype.slice||function(e,t){t=t||this.byteLength-e;var i=new Uint8Array(this,e,t),a=new Uint8Array(t);return a.set(i),a.buffer},r={jpeg:{65505:[],65517:[]}};function o(i,o,s,c){var l=this;function f(o,f){if(!(t.DataView&&a&&i&&i.size>=12&&"image/jpeg"===i.type))return o(c);var u=s.maxMetaDataSize||262144;e.readFile(a.call(i,0,u),function(e){var t=new DataView(e);if(65496!==t.getUint16(0))return f(new Error("Invalid JPEG file: Missing JPEG marker."));for(var i,a,u,d,g=2,m=t.byteLength-4,h=g;g<m&&((i=t.getUint16(g))>=65504&&i<=65519||65534===i);){if(g+(a=t.getUint16(g+2)+2)>t.byteLength){console.log("Invalid JPEG metadata: Invalid segment size.");break}if((u=r.jpeg[i])&&!s.disableMetaDataParsers)for(d=0;d<u.length;d+=1)u[d].call(l,t,g,a,c,s);h=g+=a}!s.disableImageHead&&h>6&&(c.imageHead=n.call(e,0,h)),o(c)},f,"readAsArrayBuffer")||o(c)}return s=s||{},t.Promise&&"function"!=typeof o?(c=s=o||{},new Promise(f)):(c=c||{},f(o,o))}function s(e,t,i){return e&&t&&i?new Blob([i,a.call(e,t.byteLength)],{type:"image/jpeg"}):null}e.transform=function(a,n,r,s,c){e.requiresMetaData(n)?o(s,function(o){o!==c&&(t.console&&console.log(o),o=c),i.call(e,a,n,r,s,o)},n,c=c||{}):i.apply(e,arguments)},e.blobSlice=a,e.bufferSlice=n,e.replaceHead=function(e,i,a){var n={maxMetaDataSize:1024,disableMetaDataParsers:!0};if(!a&&t.Promise)return o(e,n).then(function(t){return s(e,t.imageHead,i)});o(e,function(t){a(s(e,t.imageHead,i))},n)},e.parseMetaData=o,e.metaDataParsers=r}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(e){"use strict";var t=e.global;t.fetch&&t.Request&&t.Response&&t.Response.prototype.blob?e.fetchBlob=function(e,i,a){function n(e){return e.blob()}if(t.Promise&&"function"!=typeof i)return fetch(new Request(e,i)).then(n);fetch(new Request(e,a)).then(n).then(i).catch(function(e){i(null,e)})}:t.XMLHttpRequest&&""===(new XMLHttpRequest).responseType&&(e.fetchBlob=function(e,i,a){function n(t,i){a=a||{};var n=new XMLHttpRequest;n.open(a.method||"GET",e),a.headers&&Object.keys(a.headers).forEach(function(e){n.setRequestHeader(e,a.headers[e])}),n.withCredentials="include"===a.credentials,n.responseType="blob",n.onload=function(){t(n.response)},n.onerror=n.onabort=n.ontimeout=function(e){t===i?i(null,e):i(e)},n.send(a.body)}return t.Promise&&"function"!=typeof i?(a=i,new Promise(n)):n(i,i)})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";function t(e){e&&(Object.defineProperty(this,"map",{value:this.ifds[e].map}),Object.defineProperty(this,"tags",{value:this.tags&&this.tags[e]||{}}))}t.prototype.map={Orientation:274,Thumbnail:"ifd1",Blob:513,Exif:34665,GPSInfo:34853,Interoperability:40965},t.prototype.ifds={ifd1:{name:"Thumbnail",map:t.prototype.map},34665:{name:"Exif",map:{}},34853:{name:"GPSInfo",map:{}},40965:{name:"Interoperability",map:{}}},t.prototype.get=function(e){return this[e]||this[this.map[e]]};var i={1:{getValue:function(e,t){return e.getUint8(t)},size:1},2:{getValue:function(e,t){return String.fromCharCode(e.getUint8(t))},size:1,ascii:!0},3:{getValue:function(e,t,i){return e.getUint16(t,i)},size:2},4:{getValue:function(e,t,i){return e.getUint32(t,i)},size:4},5:{getValue:function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},size:8},9:{getValue:function(e,t,i){return e.getInt32(t,i)},size:4},10:{getValue:function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},size:8}};function a(e,t,a,n,r,o){var s,c,l,f,u,d,g=i[n];if(g){if(!((c=(s=g.size*r)>4?t+e.getUint32(a+8,o):a+8)+s>e.byteLength)){if(1===r)return g.getValue(e,c,o);for(l=[],f=0;f<r;f+=1)l[f]=g.getValue(e,c+f*g.size,o);if(g.ascii){for(u="",f=0;f<l.length&&"\0"!==(d=l[f]);f+=1)u+=d;return u}return l}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")}function n(e,t,i){return(!e||e[i])&&(!t||!0!==t[i])}function r(e,t,i,r,o,s,c,l){var f,u,d,g,m,h;if(i+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((u=i+2+12*(f=e.getUint16(i,r)))+4>e.byteLength)){for(d=0;d<f;d+=1)g=i+2+12*d,n(c,l,m=e.getUint16(g,r))&&(h=a(e,t,g,e.getUint16(g+2,r),e.getUint32(g+4,r),r),o[m]=h,s&&(s[m]=g));return e.getUint32(u,r)}console.log("Invalid Exif data: Invalid directory size.")}}i[7]=i[1],e.parseExifData=function(i,a,o,s,c){if(!c.disableExif){var l,f,u,d=c.includeExifTags,g=c.excludeExifTags||{34665:{37500:!0}},m=a+10;if(1165519206===i.getUint32(a+4))if(m+8>i.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===i.getUint16(a+8)){switch(i.getUint16(m)){case 18761:l=!0;break;case 19789:l=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===i.getUint16(m+2,l)?(f=i.getUint32(m+4,l),s.exif=new t,c.disableExifOffsets||(s.exifOffsets=new t,s.exifTiffOffset=m,s.exifLittleEndian=l),(f=r(i,m,m+f,l,s.exif,s.exifOffsets,d,g))&&n(d,g,"ifd1")&&(s.exif.ifd1=f,s.exifOffsets&&(s.exifOffsets.ifd1=m+f)),Object.keys(s.exif.ifds).forEach(function(e){!function(e,i,a,n,o,s,c){var l=e.exif[i];l&&(e.exif[i]=new t(i),e.exifOffsets&&(e.exifOffsets[i]=new t(i)),r(a,n,n+l,o,e.exif[i],e.exifOffsets&&e.exifOffsets[i],s&&s[i],c&&c[i]))}(s,e,i,m,l,d,g)}),(u=s.exif.ifd1)&&u[513]&&(u[513]=function(t,i,a){if(a){if(!(i+a>t.byteLength))return new Blob([e.bufferSlice.call(t.buffer,i,i+a)],{type:"image/jpeg"});console.log("Invalid Exif data: Invalid thumbnail data.")}}(i,m+u[513],u[514]))):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}},e.metaDataParsers.jpeg[65505].push(e.parseExifData),e.exifWriters={274:function(e,t,i){var a=t.exifOffsets[274];return a?(new DataView(e,a+8,2).setUint16(0,i,t.exifLittleEndian),e):e}},e.writeExifData=function(t,i,a,n){return e.exifWriters[i.exif.map[a]](t,i,n)},e.ExifMap=t}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-exif"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-exif")):e(window.loadImage)}(function(e){"use strict";var t=e.ExifMap.prototype;t.tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",34665:{36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber"},34853:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},40965:{1:"InteroperabilityIndex"}},t.tags.ifd1=t.tags,t.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"Original",2:"Horizontal flip",3:"Rotate 180° CCW",4:"Vertical flip",5:"Vertical flip + Rotate 90° CW",6:"Rotate 90° CW",7:"Horizontal flip + Rotate 90° CW",8:"Rotate 90° CCW"}},t.getText=function(e){var t=this.get(e);switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[e][t];case"ExifVersion":case"FlashpixVersion":if(!t)return;return String.fromCharCode(t[0],t[1],t[2],t[3]);case"ComponentsConfiguration":if(!t)return;return this.stringValues[e][t[0]]+this.stringValues[e][t[1]]+this.stringValues[e][t[2]]+this.stringValues[e][t[3]];case"GPSVersionID":if(!t)return;return t[0]+"."+t[1]+"."+t[2]+"."+t[3]}return String(t)},t.getAll=function(){var e,t,i,a={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&((t=this[e])&&t.getAll?a[this.ifds[e].name]=t.getAll():(i=this.tags[e])&&(a[i]=this.getText(i)));return a},t.getName=function(e){var t=this.tags[e];return"object"==typeof t?this.ifds[e].name:t},function(){var e,i,a,n=t.tags;for(e in n)if(Object.prototype.hasOwnProperty.call(n,e))if(i=t.ifds[e])for(e in a=n[e])Object.prototype.hasOwnProperty.call(a,e)&&(i.map[a[e]]=Number(e));else t.map[n[e]]=Number(e)}()}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";function t(){}function i(e,t,i,a,n){return"binary"===t.types[e]?new Blob([i.buffer.slice(a,a+n)]):"Uint16"===t.types[e]?i.getUint16(a):function(e,t,i){for(var a="",n=t+i,r=t;r<n;r+=1)a+=String.fromCharCode(e.getUint8(r));return a}(i,a,n)}function a(e,t){return void 0===e?t:e instanceof Array?(e.push(t),e):[e,t]}function n(e,t,n,r,o,s){for(var c,l,f,u=t+n,d=t;d<u;)28===e.getUint8(d)&&2===e.getUint8(d+1)&&(f=e.getUint8(d+2),o&&!o[f]||s&&s[f]||(l=e.getInt16(d+3),c=i(f,r.iptc,e,d+5,l),r.iptc[f]=a(r.iptc[f],c),r.iptcOffsets&&(r.iptcOffsets[f]=d))),d+=1}function r(e,t){return 943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}function o(e,t){var i=e.getUint8(t+7);return i%2!=0&&(i+=1),0===i&&(i=4),i}t.prototype.map={ObjectName:5},t.prototype.types={0:"Uint16",200:"Uint16",201:"Uint16",202:"binary"},t.prototype.get=function(e){return this[e]||this[this.map[e]]},e.parseIptcData=function(e,i,a,s,c){if(!c.disableIptc)for(var l=i+a;i+8<l;){if(r(e,i)){var f=o(e,i),u=i+8+f;if(u>l){console.log("Invalid IPTC data: Invalid segment offset.");break}var d=e.getUint16(i+6+f);if(i+d>l){console.log("Invalid IPTC data: Invalid segment size.");break}return s.iptc=new t,c.disableIptcOffsets||(s.iptcOffsets=new t),void n(e,u,d,s,c.includeIptcTags,c.excludeIptcTags||{202:!0})}i+=1}},e.metaDataParsers.jpeg[65517].push(e.parseIptcData),e.IptcMap=t}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-iptc"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-iptc")):e(window.loadImage)}(function(e){"use strict";var t=e.IptcMap.prototype;t.tags={0:"ApplicationRecordVersion",3:"ObjectTypeReference",4:"ObjectAttributeReference",5:"ObjectName",7:"EditStatus",8:"EditorialUpdate",10:"Urgency",12:"SubjectReference",15:"Category",20:"SupplementalCategories",22:"FixtureIdentifier",25:"Keywords",26:"ContentLocationCode",27:"ContentLocationName",30:"ReleaseDate",35:"ReleaseTime",37:"ExpirationDate",38:"ExpirationTime",40:"SpecialInstructions",42:"ActionAdvised",45:"ReferenceService",47:"ReferenceDate",50:"ReferenceNumber",55:"DateCreated",60:"TimeCreated",62:"DigitalCreationDate",63:"DigitalCreationTime",65:"OriginatingProgram",70:"ProgramVersion",75:"ObjectCycle",80:"Byline",85:"BylineTitle",90:"City",92:"Sublocation",95:"State",100:"CountryCode",101:"Country",103:"OriginalTransmissionReference",105:"Headline",110:"Credit",115:"Source",116:"CopyrightNotice",118:"Contact",120:"Caption",121:"LocalCaption",122:"Writer",125:"RasterizedCaption",130:"ImageType",131:"ImageOrientation",135:"LanguageIdentifier",150:"AudioType",151:"AudioSamplingRate",152:"AudioSamplingResolution",153:"AudioDuration",154:"AudioOutcue",184:"JobID",185:"MasterDocumentID",186:"ShortDocumentID",187:"UniqueDocumentID",188:"OwnerID",200:"ObjectPreviewFileFormat",201:"ObjectPreviewFileVersion",202:"ObjectPreviewData",221:"Prefs",225:"ClassifyState",228:"SimilarityIndex",230:"DocumentNotes",231:"DocumentHistory",232:"ExifCameraInfo",255:"CatalogSets"},t.stringValues={10:{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"},75:{a:"Morning",b:"Both Morning and Evening",p:"Evening"},131:{L:"Landscape",P:"Portrait",S:"Square"}},t.getText=function(e){var t=this.get(e),i=this.map[e],a=this.stringValues[i];return a?a[t]:String(t)},t.getAll=function(){var e,t,i={};for(e in this)Object.prototype.hasOwnProperty.call(this,e)&&(t=this.tags[e])&&(i[t]=this.getText(t));return i},t.getName=function(e){return this.tags[e]},function(){var e,i=t.tags,a=t.map||{};for(e in i)Object.prototype.hasOwnProperty.call(i,e)&&(a[i[e]]=Number(e))}()}),function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-scale","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-scale"),require("./load-image-meta")):e(window.loadImage)}(function(e){"use strict";var t=e.transform,i=e.requiresCanvas,a=e.requiresMetaData,n=e.transformCoordinates,r=e.getTransformedOptions;function o(t,i){var a=t&&t.orientation;return!0===a&&!e.orientation||1===a&&e.orientation||(!i||e.orientation)&&a>1&&a<9}function s(e,t){return e!==t&&(1===e&&t>1&&t<9||e>1&&e<9)}function c(e,t){if(t>1&&t<9)switch(e){case 2:case 4:return t>4;case 5:case 7:return t%2==0;case 6:case 8:return 2===t||4===t||5===t||7===t}return!1}!function(e){if(e.global.document){var t=document.createElement("img");t.onload=function(){if(e.orientation=2===t.width&&3===t.height,e.orientation){var i=e.createCanvas(1,1,!0).getContext("2d");i.drawImage(t,1,1,1,1,0,0,1,1),e.orientationCropBug="255,255,255,255"!==i.getImageData(0,0,1,1).data.toString()}},t.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAIAAwMBEQACEQEDEQH/xABRAAEAAAAAAAAAAAAAAAAAAAAKEAEBAQADAQEAAAAAAAAAAAAGBQQDCAkCBwEBAAAAAAAAAAAAAAAAAAAAABEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AG8T9NfSMEVMhQvoP3fFiRZ+MTHDifa/95OFSZU5OzRzxkyejv8ciEfhSceSXGjS8eSdLnZc2HDm4M3BxcXwH/9k="}}(e),e.requiresCanvas=function(t){return o(t)||i.call(e,t)},e.requiresMetaData=function(t){return o(t,!0)||a.call(e,t)},e.transform=function(i,a,n,r,o){t.call(e,i,a,function(t,i){if(i){var a=e.orientation&&i.exif&&i.exif.get("Orientation");if(a>4&&a<9){var r=i.originalWidth,o=i.originalHeight;i.originalWidth=o,i.originalHeight=r}}n(t,i)},r,o)},e.getTransformedOptions=function(t,i,a){var n=r.call(e,t,i),o=a.exif&&a.exif.get("Orientation"),l=n.orientation,f=e.orientation&&o;if(!0===l&&(l=o),!s(l,f))return n;var u=n.top,d=n.right,g=n.bottom,m=n.left,h={};for(var p in n)Object.prototype.hasOwnProperty.call(n,p)&&(h[p]=n[p]);if(h.orientation=l,(l>4&&!(f>4)||l<5&&f>4)&&(h.maxWidth=n.maxHeight,h.maxHeight=n.maxWidth,h.minWidth=n.minHeight,h.minHeight=n.minWidth,h.sourceWidth=n.sourceHeight,h.sourceHeight=n.sourceWidth),f>1){switch(f){case 2:d=n.left,m=n.right;break;case 3:u=n.bottom,d=n.left,g=n.top,m=n.right;break;case 4:u=n.bottom,g=n.top;break;case 5:u=n.left,d=n.bottom,g=n.right,m=n.top;break;case 6:u=n.left,d=n.top,g=n.right,m=n.bottom;break;case 7:u=n.right,d=n.top,g=n.left,m=n.bottom;break;case 8:u=n.right,d=n.bottom,g=n.left,m=n.top}if(c(l,f)){var A=u,b=d;u=g,d=m,g=A,m=b}}switch(h.top=u,h.right=d,h.bottom=g,h.left=m,l){case 2:h.right=m,h.left=d;break;case 3:h.top=g,h.right=m,h.bottom=u,h.left=d;break;case 4:h.top=g,h.bottom=u;break;case 5:h.top=m,h.right=g,h.bottom=d,h.left=u;break;case 6:h.top=d,h.right=g,h.bottom=m,h.left=u;break;case 7:h.top=d,h.right=u,h.bottom=m,h.left=g;break;case 8:h.top=m,h.right=u,h.bottom=d,h.left=g}return h},e.transformCoordinates=function(t,i,a){n.call(e,t,i,a);var r=i.orientation,o=e.orientation&&a.exif&&a.exif.get("Orientation");if(s(r,o)){var l=t.getContext("2d"),f=t.width,u=t.height,d=f,g=u;switch((r>4&&!(o>4)||r<5&&o>4)&&(t.width=u,t.height=f),r>4&&(d=u,g=f),o){case 2:l.translate(d,0),l.scale(-1,1);break;case 3:l.translate(d,g),l.rotate(Math.PI);break;case 4:l.translate(0,g),l.scale(1,-1);break;case 5:l.rotate(-.5*Math.PI),l.scale(-1,1);break;case 6:l.rotate(-.5*Math.PI),l.translate(-d,0);break;case 7:l.rotate(-.5*Math.PI),l.translate(-d,g),l.scale(1,-1);break;case 8:l.rotate(.5*Math.PI),l.translate(0,-g)}switch(c(r,o)&&(l.translate(d,g),l.rotate(Math.PI)),r){case 2:l.translate(f,0),l.scale(-1,1);break;case 3:l.translate(f,u),l.rotate(Math.PI);break;case 4:l.translate(0,u),l.scale(1,-1);break;case 5:l.rotate(.5*Math.PI),l.scale(1,-1);break;case 6:l.rotate(.5*Math.PI),l.translate(0,-u);break;case 7:l.rotate(.5*Math.PI),l.translate(f,-u),l.scale(-1,1);break;case 8:l.rotate(-.5*Math.PI),l.translate(-f,0)}}}});
